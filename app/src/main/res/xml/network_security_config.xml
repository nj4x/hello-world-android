<?xml version="1.0" encoding="utf-8"?>
<network-security-config>
    <!-- Base configuration for all domains -->
    <base-config cleartextTrafficPermitted="false">
        <trust-anchors>
            <!-- Trust system CAs for all connections -->
            <certificates src="system" />
            <!-- VPN provider certificate for Google domains -->
            <certificates src="@raw/google_com" />
            <!-- Additionally trust user-added CAs only for debug builds -->
            <certificates src="user" />
        </trust-anchors>
    </base-config>

    <!-- Specific configuration for OAuth domains -->
    <domain-config cleartextTrafficPermitted="false">
        <!-- Google OAuth domains (including regional variants) -->
        <domain includeSubdomains="true">accounts.google.com</domain>
        <domain includeSubdomains="true">accounts.google.ca</domain>
        <domain includeSubdomains="true">accounts.google.co.uk</domain>
        <domain includeSubdomains="true">accounts.google.de</domain>
        <domain includeSubdomains="true">accounts.google.fr</domain>
        <domain includeSubdomains="true">accounts.google.jp</domain>
        <domain includeSubdomains="true">accounts.google.com.au</domain>
        <domain includeSubdomains="true">accounts.google.com.br</domain>
        <domain includeSubdomains="true">accounts.google.it</domain>
        <domain includeSubdomains="true">accounts.google.es</domain>
        <domain includeSubdomains="true">accounts.google.nl</domain>
        <domain includeSubdomains="true">accounts.google.ru</domain>
        <domain includeSubdomains="true">accounts.google.cn</domain>
        <domain includeSubdomains="true">accounts.google.in</domain>
        
        <!-- Samsung OAuth domains -->
        <domain includeSubdomains="true">stg-account.samsung.com</domain>
        <domain includeSubdomains="true">account.samsung.com</domain>
        
        <!-- Trust anchors for OAuth domains -->
        <trust-anchors>
            <certificates src="system" />
            <certificates src="user" />
            <!-- VPN provider certificate for Google domains -->
            <certificates src="@raw/google_com" />
            <!-- Additional VPN provider certificate -->
            <certificates src="@raw/_.accounts.google.com" />
        </trust-anchors>
    </domain-config>

    <!-- Debug overrides (only in debug builds) -->
    <debug-overrides>
        <trust-anchors>
            <!-- Trust user CAs in debug builds for testing with Charles Proxy, etc. -->
            <certificates src="user" />
            <!-- VPN provider certificate for Google domains -->
            <certificates src="@raw/google_com" />
        </trust-anchors>
    </debug-overrides>
</network-security-config>
